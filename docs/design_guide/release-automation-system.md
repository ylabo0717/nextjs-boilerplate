# ãƒªãƒªãƒ¼ã‚¹è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸

## 1. ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### 1.1 åŸºæœ¬çš„ãªä»•çµ„ã¿

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ã€**é–‹ç™ºè€…**ã€**GitHub Actions**ã€**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†è€…**ã®3è€…ãŒå”èª¿ã—ã¦å‹•ä½œã™ã‚‹è‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

#### ç™»å ´äººç‰©ã¨å½¹å‰²

| ç™»å ´äººç‰©               | å½¹å‰²                    | å¿…è¦ãªä½œæ¥­                                   |
| ---------------------- | ----------------------- | -------------------------------------------- |
| **é–‹ç™ºè€…**             | æ©Ÿèƒ½é–‹ç™ºã¨Changesetä½œæˆ | Changesetãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦PRã«å«ã‚ã‚‹        |
| **GitHub Actions**     | è‡ªå‹•åŒ–å‡¦ç†              | ãƒªãƒªãƒ¼ã‚¹PRä½œæˆã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¨ˆç®—ã€ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œ |
| **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†è€…** | ãƒªãƒªãƒ¼ã‚¹åˆ¤æ–­            | ãƒªãƒªãƒ¼ã‚¹PRã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãƒãƒ¼ã‚¸               |

### 1.2 ãƒªãƒªãƒ¼ã‚¹ãƒ•ãƒ­ãƒ¼ã®å…¨ä½“åƒ

```mermaid
sequenceDiagram
    participant Dev as é–‹ç™ºè€…
    participant Main as mainãƒ–ãƒ©ãƒ³ãƒ
    participant GHA as GitHub Actions
    participant Manager as ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†è€…
    participant Release as ãƒªãƒªãƒ¼ã‚¹

    Note over Dev,Release: æ—¥å¸¸ã®é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºï¼ˆç¹°ã‚Šè¿”ã—ï¼‰
    Dev->>Dev: æ©Ÿèƒ½é–‹ç™º
    Dev->>Dev: pnpm changeset:add ã§Changesetä½œæˆ
    Dev->>Main: PRä½œæˆï¼ˆã‚³ãƒ¼ãƒ‰ + Changesetï¼‰
    Manager->>Main: PRãƒ¬ãƒ“ãƒ¥ãƒ¼ & ãƒãƒ¼ã‚¸
    Main->>Main: ChangesetãŒè“„ç©ã•ã‚Œã‚‹

    Note over Dev,Release: ãƒªãƒªãƒ¼ã‚¹æº–å‚™ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆè‡ªå‹•ï¼‰
    GHA->>GHA: mainãƒ–ãƒ©ãƒ³ãƒç›£è¦–
    GHA->>GHA: Changesetã‚’æ¤œå‡º
    GHA->>Main: ãƒªãƒªãƒ¼ã‚¹PRã‚’è‡ªå‹•ä½œæˆ/æ›´æ–°
    Note right of GHA: ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·è¨ˆç®—<br/>ãƒ»CHANGELOGç”Ÿæˆ<br/>ãƒ»Changesetçµ±åˆ

    Note over Dev,Release: ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œãƒ•ã‚§ãƒ¼ã‚ºï¼ˆç®¡ç†è€…åˆ¤æ–­ï¼‰
    Manager->>Manager: ãƒªãƒªãƒ¼ã‚¹PRç¢ºèª
    Manager->>Manager: ãƒªãƒªãƒ¼ã‚¹ã‚¿ã‚¤ãƒŸãƒ³ã‚°åˆ¤æ–­
    Manager->>Main: ãƒªãƒªãƒ¼ã‚¹PRãƒãƒ¼ã‚¸
    GHA->>Release: ã‚¿ã‚°ä½œæˆ
    GHA->>Release: GitHub Releaseä½œæˆ
    GHA->>Release: ã‚¢ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
```

### 1.3 é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

#### ğŸ”„ **Changesetã¯ã€Œãƒªãƒªãƒ¼ã‚¹äºˆç´„ç¥¨ã€**

- é–‹ç™ºè€…ãŒä½œæˆã™ã‚‹Changesetã¯ã€æ¬¡å›ãƒªãƒªãƒ¼ã‚¹ã«å«ã‚ãŸã„å¤‰æ›´ã®è¨˜éŒ²
- è¤‡æ•°ã®ChangesetãŒè“„ç©ã•ã‚Œã€ã¾ã¨ã‚ã¦ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã‚‹

#### ğŸ¤– **ãƒªãƒªãƒ¼ã‚¹PRã¯è‡ªå‹•ç”Ÿæˆ**

- äººé–“ãŒãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’è€ƒãˆã‚‹å¿…è¦ãªã—
- CHANGELOGã‚‚è‡ªå‹•ç”Ÿæˆ
- è¤‡æ•°ã®å¤‰æ›´ã‚’1ã¤ã®ãƒªãƒªãƒ¼ã‚¹ã«ã¾ã¨ã‚ã‚‹

#### ğŸ‘¤ **æœ€çµ‚åˆ¤æ–­ã¯äººé–“**

- ãƒªãƒªãƒ¼ã‚¹PRã®ãƒãƒ¼ã‚¸ = ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œã®ãƒˆãƒªã‚¬ãƒ¼
- ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯ç®¡ç†è€…ãŒåˆ¶å¾¡ï¼ˆé‡‘æ›œå¤•æ–¹ã‚’é¿ã‘ã‚‹ç­‰ï¼‰

### 1.4 å…·ä½“ä¾‹ã§ç†è§£ã™ã‚‹

```text
æœˆæ›œæ—¥: é–‹ç™ºè€…Aã€Œãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰è¿½åŠ ã€â†’ Changesetä»˜ãPR â†’ ãƒãƒ¼ã‚¸
ç«æ›œæ—¥: é–‹ç™ºè€…Bã€Œãƒã‚°ä¿®æ­£ã€â†’ Changesetä»˜ãPR â†’ ãƒãƒ¼ã‚¸
æ°´æ›œæ—¥: é–‹ç™ºè€…Cã€Œæ€§èƒ½æ”¹å–„ã€â†’ Changesetä»˜ãPR â†’ ãƒãƒ¼ã‚¸

æœ¨æ›œæ—¥: GitHub Actionsã€Œãƒªãƒªãƒ¼ã‚¹PRä½œæˆã—ã¾ã—ãŸï¼ˆv0.2.0äºˆå®šï¼‰ã€
        å†…å®¹: 3ã¤ã®å¤‰æ›´ã‚’ã¾ã¨ã‚ãŸCHANGELOG

é‡‘æ›œæ—¥: ç®¡ç†è€…ã€Œä»Šæ—¥ã¯ã‚„ã‚ã¦ãŠã“ã†ã€â†’ ä½•ã‚‚ã—ãªã„

æœˆæ›œæ—¥: ç®¡ç†è€…ã€Œã‚ˆã—ã€ãƒªãƒªãƒ¼ã‚¹ã—ã‚ˆã†ã€â†’ ãƒªãƒªãƒ¼ã‚¹PRãƒãƒ¼ã‚¸
        â†’ v0.2.0 ãƒªãƒªãƒ¼ã‚¹å®Œäº†ï¼
```

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 2.1 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

```mermaid
graph TB
    subgraph "é–‹ç™ºãƒ•ãƒ­ãƒ¼"
        A[é–‹ç™ºè€…] --> B[Changesetä½œæˆ]
        B --> C[PRãƒãƒ¼ã‚¸]
    end

    subgraph "GitHub Actions"
        C --> D[release.yml]
        D --> E{å¤‰æ›´æ¤œå‡º}
        E -->|changesetã‚ã‚Š| F[ãƒªãƒªãƒ¼ã‚¹PRä½œæˆ]
        E -->|æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼| G[ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒ³ãƒ—]
        F --> H[PRãƒãƒ¼ã‚¸]
        H --> I[ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œ]
        G --> I
    end

    subgraph "ãƒªãƒªãƒ¼ã‚¹å‡¦ç†"
        I --> J[GitHub Releaseä½œæˆ]
        I --> K[ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰]
        I --> L[ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç”Ÿæˆ]
        I --> M[é€šçŸ¥é€ä¿¡]
        J --> N[å¤ã„ãƒªãƒªãƒ¼ã‚¹å‰Šé™¤]
    end
```

### 2.2 ä½¿ç”¨æŠ€è¡“

- **Changesets**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã¨CHANGELOGç”Ÿæˆ
- **GitHub Actions**: CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- **GitHub CLI (gh)**: GitHub APIã®æ“ä½œ
- **Bash Scripts**: è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

## 3. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è©³ç´°

### 3.1 ãƒªãƒªãƒ¼ã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ (release.yml)

#### ãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶

```yaml
on:
  push:
    branches: [main] # mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥
  workflow_dispatch: # æ‰‹å‹•å®Ÿè¡Œ
    inputs:
      version: # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—é¸æŠ
        type: choice
        options: [patch, minor, major]
      prerelease: # ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹è­˜åˆ¥å­
        type: choice
        options: ['', beta, alpha, rc]
```

#### ã‚¸ãƒ§ãƒ–æ§‹æˆ

1. **check-changes**: Changesetã®å­˜åœ¨ç¢ºèªã¨ãƒªãƒªãƒ¼ã‚¹æ¡ä»¶åˆ¤å®š
2. **release**: ãƒªãƒªãƒ¼ã‚¹PRä½œæˆã¾ãŸã¯ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œ
3. **cleanup**: å¤ã„ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ã®å‰Šé™¤

### 3.2 å‡¦ç†ãƒ•ãƒ­ãƒ¼

#### 3.2.1 è‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ãƒ•ãƒ­ãƒ¼ï¼ˆChangesetsçµŒç”±ï¼‰

```text
1. é–‹ç™ºè€…ãŒchangesetã‚’ä½œæˆ
   â””â”€ pnpm changeset:add

2. mainãƒ–ãƒ©ãƒ³ãƒã¸ãƒãƒ¼ã‚¸
   â””â”€ GitHub Actionsèµ·å‹•

3. Changesetã®æ¤œå‡º
   â””â”€ scripts/ci/check-changesets.sh

4. ãƒªãƒªãƒ¼ã‚¹PRè‡ªå‹•ä½œæˆ
   â””â”€ changesets/action@v1

5. ãƒªãƒªãƒ¼ã‚¹PRæ‰¿èªãƒ»ãƒãƒ¼ã‚¸

6. ã‚¿ã‚°ä½œæˆã¨GitHub Releaseç”Ÿæˆ
   â””â”€ scripts/ci/create-github-release.sh
```

#### 3.2.2 æ‰‹å‹•ãƒªãƒªãƒ¼ã‚¹ãƒ•ãƒ­ãƒ¼ï¼ˆworkflow_dispatchï¼‰

```text
1. GitHub Actions UIã‹ã‚‰æ‰‹å‹•å®Ÿè¡Œ
   â””â”€ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—ã¨ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ã‚’é¸æŠ

2. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒ³ãƒ—å®Ÿè¡Œ
   â””â”€ scripts/ci/manual-version-bump.sh

3. è‡ªå‹•ã‚³ãƒŸãƒƒãƒˆã¨ã‚¿ã‚°ä½œæˆ

4. GitHub Releaseç”Ÿæˆ
   â””â”€ scripts/ci/create-github-release.sh
```

## 4. ã‚¹ã‚¯ãƒªãƒ—ãƒˆè©³ç´°

### 4.1 ä¸»è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆå                  | ç”¨é€”                              | å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°      |
| ----------------------------- | --------------------------------- | ------------------- |
| `check-changesets.sh`         | Changesetã®å­˜åœ¨ç¢ºèªã¨ãƒªãƒªãƒ¼ã‚¹åˆ¤å®š | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼é–‹å§‹æ™‚  |
| `manual-version-bump.sh`      | æ‰‹å‹•ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†          | workflow_dispatchæ™‚ |
| `create-github-release.sh`    | GitHub Releaseä½œæˆ                | ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œæ™‚      |
| `cleanup-old-prereleases.sh`  | å¤ã„ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹å‰Šé™¤              | ãƒªãƒªãƒ¼ã‚¹å®Œäº†å¾Œ      |
| `generate-release-metrics.sh` | ãƒªãƒªãƒ¼ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç”Ÿæˆ            | ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œæ™‚      |
| `upload-build-artifacts.sh`   | ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰          | ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œæ™‚      |
| `update-changeset-config.sh`  | Changesetè¨­å®šã®å‹•çš„æ›´æ–°           | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œæ™‚  |

### 4.2 check-changesets.sh

**æ¦‚è¦**: Changesetã®å­˜åœ¨ç¢ºèªã¨ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œæ¡ä»¶ã®åˆ¤å®š

**å‡ºåŠ›**:

- `has-changesets`: ChangesetãŒå­˜åœ¨ã™ã‚‹ã‹ï¼ˆtrue/falseï¼‰
- `should-release`: ãƒªãƒªãƒ¼ã‚¹ã‚’å®Ÿè¡Œã™ã¹ãã‹ï¼ˆtrue/falseï¼‰

**åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯**:

```bash
# Changesetã®å­˜åœ¨ç¢ºèª
find .changeset -name '*.md' ! -name 'README.md'

# ãƒªãƒªãƒ¼ã‚¹æ¡ä»¶
# 1. workflow_dispatch ã‚¤ãƒ™ãƒ³ãƒˆ
# 2. ã‚¿ã‚°ãƒ—ãƒƒã‚·ãƒ¥ (v* ãƒ‘ã‚¿ãƒ¼ãƒ³)
```

### 4.3 manual-version-bump.sh

**æ¦‚è¦**: æ‰‹å‹•ãƒªãƒªãƒ¼ã‚¹æ™‚ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°å‡¦ç†

**å‡¦ç†å†…å®¹**:

1. ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—
2. Changesetä½œæˆï¼ˆcreate-changeset.shå‘¼ã³å‡ºã—ï¼‰
3. ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°ï¼ˆchangeset versionå®Ÿè¡Œï¼‰
4. Gitã‚³ãƒŸãƒƒãƒˆã¨ã‚¿ã‚°ä½œæˆ
5. ãƒªãƒ¢ãƒ¼ãƒˆã¸ãƒ—ãƒƒã‚·ãƒ¥

### 4.4 create-github-release.sh

**æ¦‚è¦**: GitHub Releaseã®ä½œæˆã¨ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆç”Ÿæˆ

**æ©Ÿèƒ½**:

- CHANGELOGã‹ã‚‰ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆæŠ½å‡º
- ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ãƒ•ãƒ©ã‚°ã®ã‚µãƒãƒ¼ãƒˆ
- GitHub CLI (gh) ã‚’ä½¿ç”¨ã—ãŸReleaseä½œæˆ

**ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆæŠ½å‡ºãƒ­ã‚¸ãƒƒã‚¯**:

```bash
# CHANGELOGã‹ã‚‰è©²å½“ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŠ½å‡º
awk -v version="$VERSION" '
  /^## / {
    if ($2 == version) { found = 1; next }
    else if (found) { exit }
  }
  found { print }
' CHANGELOG.md
```

### 4.5 cleanup-old-prereleases.sh

**æ¦‚è¦**: å¤ã„ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è‡ªå‹•å‰Šé™¤

**ä¸»è¦æ©Ÿèƒ½**:

- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œã®ãƒªãƒªãƒ¼ã‚¹å–å¾—
- è¨­å®šå¯èƒ½ãªä¿æŒæœŸé–“ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ30æ—¥ï¼‰
- æœ€æ–°Nä»¶ã®ä¿æŒï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ5ä»¶ï¼‰
- ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³æ©Ÿèƒ½
- å¯¾è©±çš„ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³**:

```bash
--dry-run    # å‰Šé™¤å¯¾è±¡ã®ç¢ºèªã®ã¿ï¼ˆå®Ÿéš›ã«ã¯å‰Šé™¤ã—ãªã„ï¼‰
--days N     # Næ—¥ã‚ˆã‚Šå¤ã„ãƒªãƒªãƒ¼ã‚¹ã‚’å‰Šé™¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30ï¼‰
--keep N     # æœ€æ–°Nä»¶ã¯ä¿æŒï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5ï¼‰
--force      # ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—
```

**å‰Šé™¤å¯¾è±¡ã®åˆ¤å®šæ¡ä»¶**:

1. ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ã§ã‚ã‚‹ï¼ˆprerelease: trueï¼‰
2. ãƒ‰ãƒ©ãƒ•ãƒˆã§ãªã„ï¼ˆdraft: falseï¼‰
3. ä½œæˆæ—¥ãŒæŒ‡å®šæ—¥æ•°ã‚ˆã‚Šå¤ã„
4. æœ€æ–°Nä»¶ã‚ˆã‚Šå¤ã„
5. ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã®ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ä¸€è‡´
   - ä¾‹: `v1.0.0-beta.1`, `v2.0.0-alpha.3`

### 4.6 generate-release-metrics.sh

**æ¦‚è¦**: ãƒªãƒªãƒ¼ã‚¹æ™‚ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ã¨è¨˜éŒ²

**åé›†ãƒ¡ãƒˆãƒªã‚¯ã‚¹**:

- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·
- ãƒªãƒªãƒ¼ã‚¹æ—¥æ™‚
- ã‚³ãƒŸãƒƒãƒˆSHA
- ãƒ“ãƒ«ãƒ‰æ™‚é–“
- ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸

**å‡ºåŠ›å…ˆ**:

- `release-metrics.json`: ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ‡ãƒ¼ã‚¿
- GitHub Step Summary: UIè¡¨ç¤ºç”¨ã‚µãƒãƒªãƒ¼

## 5. Changesetsè¨­å®š

### 5.1 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

**.changeset/config.json**:

```json
{
  "changelog": [
    "@changesets/changelog-github",
    {
      "repo": "WILL_BE_AUTO_REPLACED"
    }
  ],
  "commit": false, // è‡ªå‹•ã‚³ãƒŸãƒƒãƒˆç„¡åŠ¹ï¼ˆGitHub Actionsã§åˆ¶å¾¡ï¼‰
  "access": "restricted", // ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
  "baseBranch": "main"
}
```

### 5.2 å‹•çš„è¨­å®šæ›´æ–°

`update-changeset-config.sh`ã«ã‚ˆã‚Šã€å®Ÿè¡Œæ™‚ã«ãƒªãƒã‚¸ãƒˆãƒªåã‚’å‹•çš„ã«è¨­å®š:

- `"WILL_BE_AUTO_REPLACED"`ã¨ã„ã†ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼å€¤ã‚’`GITHUB_REPOSITORY`ç’°å¢ƒå¤‰æ•°ã§è‡ªå‹•ç½®æ›
- ã“ã®å€¤ã¯æ‰‹å‹•ã§è¨­å®šã™ã‚‹å¿…è¦ã¯ãªãã€GitHub Actionså®Ÿè¡Œæ™‚ã«è‡ªå‹•çš„ã«æ­£ã—ã„å€¤ã«æ›´æ–°ã•ã‚Œã‚‹
- ãƒ•ã‚©ãƒ¼ã‚¯æ™‚ã‚„ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆåˆ©ç”¨æ™‚ã‚‚è‡ªå‹•ã§å¯¾å¿œ

## 6. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¨­å®š

### 6.1 package.json ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```json
{
  "scripts": {
    "changeset": "changeset",
    "changeset:add": "changeset add",
    "changeset:version": "changeset version",
    "changeset:publish": "changeset publish",
    "release": "pnpm build && pnpm changeset:publish",
    "release:check": "changeset status --verbose"
  }
}
```

### 6.2 ä¾å­˜é–¢ä¿‚

- `@changesets/cli`: ^2.29.5
- `@changesets/changelog-github`: ^0.5.1

## 7. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨æ¨©é™

### 7.1 GitHub Actionsæ¨©é™

```yaml
permissions:
  contents: write # ãƒªãƒªãƒ¼ã‚¹ä½œæˆã€ã‚¿ã‚°ãƒ—ãƒƒã‚·ãƒ¥
  pull-requests: write # PRä½œæˆã€ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿
  issues: write # Issueæ“ä½œ
  packages: write # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹ï¼ˆå°†æ¥å¯¾å¿œï¼‰
```

### 7.2 ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†

- `GITHUB_TOKEN`: GitHub Actionsãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨
- è¿½åŠ ã®èªè¨¼æƒ…å ±ã¯ä¸è¦ï¼ˆGitHub CLIãŒè‡ªå‹•èªè¨¼ï¼‰

## 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 8.1 ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¨ãƒ©ãƒ¼å‡¦ç†

å…¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä»¥ä¸‹ã‚’å®Ÿè£…:

```bash
set -euo pipefail  # ã‚¨ãƒ©ãƒ¼æ™‚å³åº§ã«çµ‚äº†
```

### 8.2 ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥

- APIå‘¼ã³å‡ºã—: 0.5ç§’ã®é…å»¶ã‚’æŒŸã‚“ã§ãƒ¬ãƒ¼ãƒˆåˆ¶é™å›é¿
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³: æœ€å¤§50ãƒšãƒ¼ã‚¸ã¾ã§å–å¾—

### 8.3 ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

- CHANGELOGãŒå­˜åœ¨ã—ãªã„å ´åˆ: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½¿ç”¨
- ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—å¤±æ•—æ™‚: "N/A"è¡¨ç¤º

## 9. é‹ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### 9.1 æ—¥å¸¸çš„ãªãƒªãƒªãƒ¼ã‚¹ä½œæ¥­

#### é–‹ç™ºè€…ã®ä½œæ¥­

1. **æ©Ÿèƒ½é–‹ç™ºå®Œäº†æ™‚**:

   ```bash
   # Changesetã‚’ä½œæˆ
   pnpm changeset:add

   # å¤‰æ›´ã‚¿ã‚¤ãƒ—ã‚’é¸æŠï¼ˆpatch/minor/majorï¼‰
   # å¤‰æ›´å†…å®¹ã‚’è¨˜è¿°
   ```

2. **PRã«Changesetã‚’å«ã‚ã¦ãƒãƒ¼ã‚¸**

#### ãƒªãƒªãƒ¼ã‚¹ç®¡ç†è€…ã®ä½œæ¥­

1. **ãƒªãƒªãƒ¼ã‚¹PRã®ç¢ºèª**:
   - è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸPRã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼
   - CHANGELOGã®å†…å®¹ç¢ºèª
   - ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã®å¦¥å½“æ€§ç¢ºèª

2. **ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œ**:
   - ãƒªãƒªãƒ¼ã‚¹PRã‚’ãƒãƒ¼ã‚¸ â†’ è‡ªå‹•ã§ãƒªãƒªãƒ¼ã‚¹å®Œäº†

### 9.2 ç·Šæ€¥ãƒªãƒªãƒ¼ã‚¹æ‰‹é †

1. GitHub Actions â†’ Release workflow â†’ Run workflow
2. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—é¸æŠï¼ˆpatch/minor/majorï¼‰
3. ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹è­˜åˆ¥å­é¸æŠï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
4. å®Ÿè¡Œ â†’ è‡ªå‹•ã§ãƒªãƒªãƒ¼ã‚¹å®Œäº†

### 9.3 ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹é‹ç”¨

#### ãƒ™ãƒ¼ã‚¿ç‰ˆãƒªãƒªãƒ¼ã‚¹ä¾‹

```bash
# ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ãƒ¢ãƒ¼ãƒ‰é–‹å§‹
pnpm changeset pre enter beta

# å¤‰æ›´ã‚’è¿½åŠ 
pnpm changeset:add

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°
pnpm changeset:version

# ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ãƒ¢ãƒ¼ãƒ‰çµ‚äº†
pnpm changeset pre exit
```

### 9.4 ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä½œæ¥­

#### å¤ã„ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

è‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹ãŒã€æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½:

```bash
# ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼ˆç¢ºèªã®ã¿ï¼‰
./scripts/ci/cleanup-old-prereleases.sh --dry-run

# 7æ—¥ä»¥ä¸Šå¤ã„ã‚‚ã®ã‚’å‰Šé™¤
./scripts/ci/cleanup-old-prereleases.sh --days 7

# æœ€æ–°3ä»¶ã®ã¿ä¿æŒ
./scripts/ci/cleanup-old-prereleases.sh --keep 3
```

## 10. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### 10.1 ã‚ˆãã‚ã‚‹å•é¡Œã¨å¯¾å‡¦æ³•

| å•é¡Œ                     | åŸå›                   | å¯¾å‡¦æ³•                          |
| ------------------------ | --------------------- | ------------------------------- |
| ãƒªãƒªãƒ¼ã‚¹PRãŒä½œæˆã•ã‚Œãªã„ | ChangesetãŒå­˜åœ¨ã—ãªã„ | `.changeset/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç¢ºèª |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ›´æ–°ã•ã‚Œãªã„ | Changesetè¨­å®šã‚¨ãƒ©ãƒ¼   | config.jsonã®è¨­å®šç¢ºèª           |
| GitHub Releaseä½œæˆå¤±æ•—   | æ¨©é™ä¸è¶³              | GitHub Actionsæ¨©é™è¨­å®šç¢ºèª      |
| ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹å‰Šé™¤å¤±æ•—     | APIãƒ¬ãƒ¼ãƒˆåˆ¶é™         | æ™‚é–“ã‚’ç½®ã„ã¦å†å®Ÿè¡Œ              |

### 10.2 ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

1. **GitHub Actions ãƒ­ã‚°ç¢ºèª**:
   - å„ã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°ãƒ­ã‚°ã‚’å±•é–‹
   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç¢ºèª

2. **ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ†ã‚¹ãƒˆ**:

   ```bash
   # ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãƒ†ã‚¹ãƒˆ
   export GITHUB_REPOSITORY="owner/repo"
   export GITHUB_TOKEN="your-token"
   ./scripts/ci/check-changesets.sh
   ```

3. **ChangesetsçŠ¶æ…‹ç¢ºèª**:
   ```bash
   pnpm release:check
   ```

## 11. å‚è€ƒè³‡æ–™

### å¤–éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Changesetså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://github.com/changesets/changesets)
- [GitHub Actions ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.github.com/en/actions)
- [GitHub CLI (gh) ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://cli.github.com/manual/)
- [ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°](https://semver.org/lang/ja/)

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- `.github/workflows/release.yml`: ãƒªãƒªãƒ¼ã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾©
- `.changeset/config.json`: Changesetsè¨­å®š
- `scripts/ci/`: è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆç¾¤
- `docs/work_dir/release-automation-guide.md`: ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã‚¬ã‚¤ãƒ‰
- `docs/work_dir/github_actions_ci_design.md`: CI/CDè¨­è¨ˆæ›¸

---

_æœ€çµ‚æ›´æ–°: 2025å¹´8æœˆ13æ—¥_
_ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0.0_
